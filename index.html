<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Operaci贸n Nochebuena</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 20px auto; }
    button { margin-top: 10px; padding: 10px 20px; }
    #fotoPreview { max-width: 100%; margin-top: 10px; }
  </style>
</head>
<body>

  <h1>Operaci贸n Nochebuena</h1>

  <section>
    <h2>Tu misi贸n secreta </h2>
    <button id="btnMision">Obtener misi贸n</button>
    <p id="mision"></p>
  </section>

  <section>
    <h2>Capsula del tiempo 2026 </h2>
    <form id="capsulaForm">
      <label for="texto">Escribe tu predicci贸n o mensaje:</label><br/>
      <textarea id="texto" name="texto" rows="3" cols="40" required></textarea><br/>

      <label for="foto">Selecciona una foto:</label><br/>
      <input type="file" id="foto" name="file" accept="image/*" required/><br/>

      <button type="submit">Enviar a la c谩psula</button>
    </form>

    <p id="respuesta"></p>
  </section>

</body>

<script>
  const btnMision = document.getElementById('btnMision');
  const misionP = document.getElementById('mision');
  const capsulaForm = document.getElementById('capsulaForm');
  const respuestaP = document.getElementById('respuesta');

  const baseUrl = 'http://127.0.0.1:8000'; // Cambia si usas otro puerto

  btnMision.addEventListener('click', async () => {
    try {
      const res = await fetch(`${baseUrl}/mision`);
      const data = await res.json();
      misionP.textContent = data.mision;
    } catch (error) {
      misionP.textContent = 'Error al obtener misi贸n';
    }
  });

  capsulaForm.addEventListener('submit', async (e) => {
    e.preventDefault();

    const formData = new FormData();
    formData.append('texto', document.getElementById('texto').value);
    formData.append('file', document.getElementById('foto').files[0]);

    try {
      const res = await fetch(`${baseUrl}/capsula`, {
        method: 'POST',
        body: formData
      });
      const data = await res.json();
      respuestaP.textContent = data.mensaje;
      capsulaForm.reset();
    } catch (error) {
      respuestaP.textContent = 'Error al enviar foto';
    }
  });
</script>

</html>
